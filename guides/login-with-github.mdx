## Login With GitHub

If you've read the Login With Google guide, you would have learned that Flipt supports many methods of authentication for users to control who has access to what in Flipt.

Alongside the suport for OIDC Login that supports many providers, Flipt has launched support for login in with GitHub in version [v1.26.0](https://github.com/flipt-io/flipt/tree/v1.26.0), through the OAuth2.0 flow! This guide will serve as a walk-through on how to set this flow up for users of Flipt in your organization(s).

## Prerequisites

- [Docker](https://www.docker.com/)
- [GitHub](https://github.com/)
- [Ngrok](https://ngrok.com/)

## Brief on OAuth2.0

OAuth2.0 is an authentication standard whose goal is to allow 3rd party applications to access authorized resources from a provider. It relies on the user explicity granting access to the 3rd party application to issue a token on behalf of the OAuth2.0 provider for authorized use.

![OAuth2.0 Flow Diagram](/images/guides/login-with-github/oauth-flow-diagram.png)

In comparison to OIDC, OAuth2.0 does not have an identity standard, so retreiving identity can vary drastically from provider to provider. Therefore, it is up to the user to consult the OAuth2.0 provider's documentation to understand if and how identity informatiuon can be retrieved.

## Creating OAuth2.0 application on GitHub

1. Navigate to your GH account, and click on `Settings` under the menu of your Profile icon

2. At the bottom of the menu on the left, you should see the menu option called `Developer Settings`, click on that

3. This should bring you to a page that has `OAuth Apps` as a menu option on the left, click on that and click `New OAuth App` to start creating the application

4. You should be brought to a page that looks like the image below, and can start filling out the information:

![OAuth2.0 App Creation](/images/guides/login-with-github/oauth-registration.png)

- `Application Name`: Give your application a meaningful name that relates to your organization possibly
- `Homepage URL`: Usually Flipt will be used internally by organizations, so this value really depends on how you plan to expose Flipt. When in doubt you can just use the URL to your organizations home page
- `Authorization callback URL`: This value requires a publicly accessible endpoint on the internet. Thankfully, there are tools such as [ngrok](https://ngrok.com/) that will allow public traffic to an app served locally on a computer. Since we will be running Flipt in docker container locally, you can fire up `ngrok` and point it to the port 8080 on your local machine, with the following command

```bash
$ ngrok http 8080
```

Copy the https URL that `ngrok` provides, and append `/auth/v1/method/github/callback` to it. This will be the value you should put for the callback URL. (e.g. https://36f1-2600-1700-1d64-daa0-444c-3f7e-ceb7-3825.ngrok-free.app/auth/v1/method/github/callback).

(**Note**: Using `ngrok` is just to get started with getting the GitHub OAuth2.0 flow working. In a production setting, if Flipt is publicly accessible, you can use that host name instead of `ngrok`. These values can always be changed later after creation of the app.)

5. Retrieve the `Client ID` and `Client Secret` from the created OAuth2.0 app

The Client ID should already be provided to you. For a client secret, you will have to generate that. Click on the `Generate a new client secret` button (it might ask you to authenticate again with GH).

## Running Flipt Locally

1. Define a `config.yml`

Flipt relies on configuration that the user provides for many bits of functionality. In order to enable Login With GitHub feature, you must define a configuration file `config.yml` in this case.

Our [documentation](https://www.flipt.io/docs/configuration/overview) gives a complete list of all configuration values available for how to configure Flipt.

Under Authentication Methods: GitHub. You should see the values that need to be provided in order to enable the login feature.

It should look like the following:

```yaml
version: "1.0"

log:
  level: DEBUG

authentication:
  required: true
  session:
    domain: ${REDIRECT_ADDRESS}
  methods:
    github:
      enabled: true
      client_id: ${CLIENT_ID}
      client_secret: ${CLIENT_SECRET}
      redirect_address: ${REDIRECT_ADDRESS}
      scopes:
        - "user:email"
```

The `client_id` and `client_secret` are going to be to values from your GitHub OAuth application. The `redirect_address` will be the `ngrok` URL with no path (e.g. https://36f1-2600-1700-1d64-daa0-444c-3f7e-ceb7-3825.ngrok-free.app). The `scopes` is entirely dependent on what level of access you would like the returned GH access token to have. [Here](https://docs.github.com/en/apps/oauth-apps/building-oauth-apps/scopes-for-oauth-apps) is a list of scopes that you can use.

The last bit of configuration is the session details. In order for the browser to establish a session to communicate with Flipt in an authenticated way, we provide access details in an HTTP cookie whose value is a static token created by Flipt. This static token is created during the GH OAuth2.0 flow, and associated with the GH access token and other metadata. The domain value will specify which hosts can receive a cookie. Since we only care about the host that is serving Flipt you can provide the `ngrok` URL value but without the `https://` prefix (e.g. 36f1-2600-1700-1d64-daa0-444c-3f7e-ceb7-3825.ngrok-free.app).

2. Run the Docker container

```bash
docker run -it --rm \
  -p 8080:8080 \
  -v "$(pwd)/config.yml:/config.yml" \
  flipt/flipt:latest --config /config.yml
```

This will mount the `config.yml` as a volume in the container, and Flipt will use that configuration as it is provided as a command line flag option.

3. Login With GitHub

Access the front end by typing in the `ngrok` URL in the address bar of a browser. You should see the following screen:

![Login With GitHub](/images/guides/login-with-github/login-with-github.png)

Click the button to Login With GitHub, and it should take you to the GH domain to complete the authentication flow with the following screen:

![GitHub Authorization](/images/guides/login-with-github/github-authorization.png)

Click on the green `Authorize {username}` button to allow completion of the OAuth2.0 flow

4. âœ… Start using Flipt

After completion of the flow you should be taken to the normal Flipt homepage and start using Flipt normally as before. If you have a profile picture on GH, it should show in the top right corner.

![Flipt Homepage](/images/guides/login-with-github/flipt-homepage.png)

## Conclusion

This guide shows the basics of getting Flipt running with GH OAuth2.0 authentication in a development setting using `ngrok`. Now that you know the basics, you can tailor the configuration pieces to fit your exact use cases. For instance, you probably would not use `ngrok` in a production setting, but rather a custom domain. If you have a custom domain, you can modify the `Authorization Callback URL` value on the GH OAuth application page, the `redirect_address`, and `domain` configuration values for the Flipt configuration.
